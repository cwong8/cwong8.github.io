<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta charset="UTF-8">
  <title>cwong8.github.io</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
</head>

  <body>
    <section class="page-header">
      <h1 class="project-name"><a href="http://localhost:4000"><font color="white">Christopher Wong</font></a></h1>
      <a href="/about/" class="btn">About</a>
      <a href="/resume/Christopher.Wong.pdf" class="btn">Resume</a>
      <a href="mailto:cwong680@gmail.com" class="btn">Email me</a>
      <h2 class="page-name"><font color="white" size="22">Chicago (2002 film)</font></h2>
    </section>

    <section class="main-content">
      
      <h1 id="introduction">Introduction</h1>

<p>Our data file contains two columns, one containing the daily average receipts per theater for the movie and the other dates from January 3, 2003 to April 18, 2003. In total, we have 106 observations, one for each day. Our data is a time series because it is a set of observations recorded at specific times. In our case, we have a descrete-time time series because we record one observation per day (daily). Time series modeling can allow us to predict/forecast long-term trends after removing the presence of seasonal components.</p>

<h1 id="the-data">The Data</h1>

<p>Let’s take a look at our plotted data: <img src="Chicago_files/figure-markdown_github/unnamed-chunk-2-1.png" style="display: block; margin: auto;" /> We notice that there is some kind of seasonality in our data because we have a very sharp increase and decrease in average receipts per theater approximately every 7 days (or a week). Oscillations with fixed periods clue us into the fact that there is seasonality in our data. After doing a bit of research online, we find that was released on December 27, 2002 and our data started to be collected about a week after launch (January 3, 2003). Hence, we expect to see a gradual decrease in average receipts per theater the longer the movie has been out. This is confirmed when we look at our time series plot and see that the general trend is decreasing as time increases. Since there is both trend and seasonality present in our data, we will model our data with a smooth part for trend, a seasonal part for seasonality, and the rough part will be determined later. Our model will be as follows:
<em>Y</em><sub><em>t</em></sub> = <em>m</em><sub><em>t</em></sub> + <em>s</em><sub><em>t</em></sub> + <em>X</em><sub><em>t</em></sub>  <em>t</em> = 1, …, 106
 where <em>Y</em><sub><em>t</em></sub> is our observed data (average receipts per theater), <em>m</em><sub><em>t</em></sub> is our trend, <em>s</em><sub><em>t</em></sub> is our seasonality, and <em>X</em><sub><em>t</em></sub> is our rough part.</p>

<h1 id="the-data-and-transformations">The Data and Transformations</h1>

<p>Here is our plotted data again: <img src="Chicago_files/figure-markdown_github/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /> where t = 1 corresponds to January 3, 2003 and t = 106 corresponds to April 18, 2003.</p>

<p>We plot a few common Box-Cox transformations for <em>λ</em> = -2, -1, 0, 1, 2 <img src="Chicago_files/figure-markdown_github/unnamed-chunk-4-1.png" style="display: block; margin: auto;" /><img src="Chicago_files/figure-markdown_github/unnamed-chunk-4-2.png" style="display: block; margin: auto;" /> We see that for <em>λ</em> = 0, i.e. the (natural) log transform, the fluctuations in our data seem to be almost the same over time unlike the other transformations above. Thus, we will choose to work with our log-transformed data from here on out. Also, we can verify that while this is not the absolute best transformation, it is very reasonable. We use the function from the library and find that <em>λ</em> = -0.1010101 is the absolute best transformation. The plot of the log-likelihood vs <em>λ</em> given below also includes a 95% confidence interval for <em>λ</em> and clearly <em>λ</em> = 0 is in that interval which makes it a very reasonable transformation. <img src="Chicago_files/figure-markdown_github/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /></p>

<h1 id="trend-and-seasonality">Trend and Seasonality</h1>

<p><img src="Chicago_files/figure-markdown_github/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /> After tinkering around with a few values, we find that a degree 4 polynomial model fits the trend very well, so we choose to go with a degree 4 polynomial model. We also find that a weekly (7 day) seasonality period matches up very well with our oscillations in our data. Our fitted model turns out to be
<em>Y</em><sub><em>t</em></sub><sup>′</sup> = <em>β</em><sub>0</sub> + <em>β</em><sub>1</sub><em>t</em> + <em>β</em><sub>2</sub><em>t</em><sup>2</sup> + <em>β</em><sub>3</sub><em>t</em><sup>3</sup> + <em>β</em><sub>4</sub><em>t</em><sup>4</sup> + <em>β</em><sub>5</sub><em>I</em><sub><em>t</em>, 1</sub> + <em>β</em><sub>6</sub><em>I</em><sub><em>t</em>, 2</sub> + <em>β</em><sub>7</sub><em>I</em><sub><em>t</em>, 3</sub> + <em>β</em><sub>8</sub><em>I</em><sub><em>t</em>, 4</sub> + <em>β</em><sub>9</sub><em>I</em><sub><em>t</em>, 5</sub> + <em>β</em><sub>10</sub><em>I</em><sub><em>t</em>, 6</sub> + <em>X</em><sub><em>t</em></sub>
 where <em>β</em><sub>0</sub> = 7.776851, <em>β</em><sub>1</sub> = 5.9398264, <em>β</em><sub>2</sub> = −40.4796609, <em>β</em><sub>3</sub> = 60.9748347, <em>β</em><sub>4</sub> = −28.8558188, <em>β</em><sub>5</sub> = 0.501546, <em>β</em><sub>6</sub> = 0.9461506, <em>β</em><sub>7</sub> = 0.415075, <em>β</em><sub>8</sub> = −0.5528182, <em>β</em><sub>9</sub> = −0.4385818, <em>β</em><sub>10</sub> = −0.4686461.</p>

<h1 id="plots-of-the-trend-seasonal-component-rough">Plots of the trend, seasonal component, rough</h1>

<p><img src="Chicago_files/figure-markdown_github/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /><img src="Chicago_files/figure-markdown_github/unnamed-chunk-7-2.png" style="display: block; margin: auto;" /><img src="Chicago_files/figure-markdown_github/unnamed-chunk-7-3.png" style="display: block; margin: auto;" /></p>

<h1 id="diagnostics-for-the-rough">Diagnostics for the Rough</h1>

<p><img src="Chicago_files/figure-markdown_github/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /> We see that the rough looks centered around 0 and has equal variance for the most part except for the one outlier at t = 18.</p>

<p><img src="Chicago_files/figure-markdown_github/unnamed-chunk-9-1.png" style="display: block; margin: auto;" /> The assumption of normality is satisfied because the all of our points except the the last one lie on the qqline and the histogram looks normal except for the one outlier at the end.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
##  Box-Ljung test
## 
## data:  chicago$`Average receipts per theater`
## X-squared = 391.72, df = 10, p-value &lt; 2.2e-16
</code></pre></div></div>

<p>Since our p-value ≈ 0 &lt; 0.05, we reject the assumption of independence for our data. It is safe to say at this point that we have a stationary sequence.</p>

<p><img src="Chicago_files/figure-markdown_github/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /><img src="Chicago_files/figure-markdown_github/unnamed-chunk-11-2.png" style="display: block; margin: auto;" /> Our ACF and PACF plots look consistent with what we would expect from an AR(1) model which we will expand on in the next section.</p>

<h1 id="obtaining-an-appropriate-arp-model">Obtaining an appropriate AR(p) model</h1>

<p>From the previous section, the ACF plot gradually tails off to 0, kind of oscillating around it for a while. On the other hand, the PACF plot cuts off after lag 1 (for the most part) which is consistent with an AR(1) model. Below is a table for the AICC values for different AR(p) models:
<img src="Chicago_files/figure-markdown_github/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /><img src="Chicago_files/figure-markdown_github/unnamed-chunk-13-2.png" style="display: block; margin: auto;" /> Looking at the ACF and PACF plots of our AR(1) model residuals, we can safely say that the residuals are white noise since all of them lie within the 95% confidence interval (for the most part). We can also perform a Box-Ljung test to show that they are indeed independent:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
##  Box-Ljung test
## 
## data:  fit$residuals
## X-squared = 6.3948, df = 10, p-value = 0.7811
</code></pre></div></div>

<h1 id="predicting-the-last-7-days">Predicting the last 7 days</h1>

<h2 id="with-the-first-99-observations">With the first 99 observations</h2>

<p><img src="Chicago_files/figure-markdown_github/unnamed-chunk-15-1.png" style="display: block; margin: auto;" /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Time Series:
## Start = 100 
## End = 106 
## Frequency = 1 
##          [,1]
## [1,] 6.465702
## [2,] 5.849715
## [3,] 4.786403
## [4,] 4.804757
## [5,] 4.671551
## [6,] 4.619667
## [7,] 5.410379
</code></pre></div></div>

<p><img src="Chicago_files/figure-markdown_github/unnamed-chunk-15-2.png" style="display: block; margin: auto;" /></p>

<h2 id="with-the-best-model-using-all-observations">With the best model using ALL observations</h2>

<p><img src="Chicago_files/figure-markdown_github/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Time Series:
## Start = 107 
## End = 113 
## Frequency = 1 
##          [,1]
## [1,] 6.384161
## [2,] 5.676363
## [3,] 4.577408
## [4,] 4.575467
## [5,] 4.430917
## [6,] 4.378264
## [7,] 5.157213
</code></pre></div></div>

<p><img src="Chicago_files/figure-markdown_github/unnamed-chunk-16-2.png" style="display: block; margin: auto;" /></p>

<h1 id="final-model">Final model</h1>

<p>Our final model turns out to be
<em>Y</em><sub><em>t</em></sub><sup>′</sup> = <em>β</em><sub>0</sub> + <em>β</em><sub>1</sub><em>t</em> + <em>β</em><sub>2</sub><em>t</em><sup>2</sup> + <em>β</em><sub>3</sub><em>t</em><sup>3</sup> + <em>β</em><sub>4</sub><em>t</em><sup>4</sup> + <em>β</em><sub>5</sub><em>I</em><sub><em>t</em>, 1</sub> + <em>β</em><sub>6</sub><em>I</em><sub><em>t</em>, 2</sub> + <em>β</em><sub>7</sub><em>I</em><sub><em>t</em>, 3</sub> + <em>β</em><sub>8</sub><em>I</em><sub><em>t</em>, 4</sub> + <em>β</em><sub>9</sub><em>I</em><sub><em>t</em>, 5</sub> + <em>β</em><sub>10</sub><em>I</em><sub><em>t</em>, 6</sub> + <em>β</em><sub>11</sub> + <em>β</em><sub>12</sub><em>X</em><sub><em>t</em> − 1</sub> + <em>ϵ</em><sub><em>t</em></sub>
 where <em>β</em><sub>0</sub> = 7.776851, <em>β</em><sub>1</sub> = 5.9398264, <em>β</em><sub>2</sub> = −40.4796609, <em>β</em><sub>3</sub> = 60.9748347, <em>β</em><sub>4</sub> = −28.8558188, <em>β</em><sub>5</sub> = 0.501546, <em>β</em><sub>6</sub> = 0.9461506, <em>β</em><sub>7</sub> = 0.415075, <em>β</em><sub>8</sub> = −0.5528182, <em>β</em><sub>9</sub> = −0.4385818, <em>β</em><sub>10</sub> = −0.4686461, <em>β</em><sub>11</sub> = <em>μ</em>(1 − <em>ϕ</em>), <em>β</em><sub>12</sub> = <em>ϕ</em>.</p>

<p>A simpler description would be that we model our trend with a degree 4 polynomial, our seasonality (which has period 7) with 6 indicator variables, and our rough by an AR(1) model.</p>

<p>Also, our model is not perfect. There are ways to improve, e.g. using loess to model the trend instead of a polynomial.</p>

<p>Doing some background research, we found that January 3, 2003 was actually a Friday which may explain why average receipts per theater increases every week (7 day period) after that and peaks on a Saturday before slowing down Sunday and dropping off on the weekdays. We also expect the trend to be decreasing because movies usually have an initial boom upon release and gradually earns less as more and more people have gone to see it already. So, by the time it has been over 105 days (15 weeks), we expect the movie to be earning very little.</p>

<h1 id="code-appendix">Code Appendix</h1>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">setwd</span><span class="p">(</span><span class="s2">"C:/Users/Christopher/Desktop/STA 137/Midterm"</span><span class="p">)</span><span class="w">
</span><span class="n">source</span><span class="p">(</span><span class="s2">"trndseas.R"</span><span class="p">)</span><span class="w">
</span><span class="n">source</span><span class="p">(</span><span class="s2">"C:/Users/Christopher/Desktop/STA 137/Homework 4/aicc.R"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span><span class="w">

</span><span class="n">chicago</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.delim</span><span class="p">(</span><span class="s2">"C:/Users/Christopher/Desktop/STA 137/Midterm/chicago.txt"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">chicago</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Average receipts per theater"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Date"</span><span class="p">)</span><span class="w">
</span><span class="n">chicago1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">chicago</span><span class="w">

</span><span class="c1"># The Data</span><span class="w">
</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">,</span><span class="w">
        </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Avg receipts per theater for Chicago (Jan 3, 2003 to Apr 18, 2003"</span><span class="p">)</span><span class="w">

</span><span class="c1"># The Data and Transformations</span><span class="w">
</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">,</span><span class="w">
        </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Avg receipts per theater for Chicago (Jan 3, 2003 to Apr 18, 2003"</span><span class="p">)</span><span class="w">
</span><span class="n">transformPlots</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">data</span><span class="p">){</span><span class="w">
  </span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
  </span><span class="n">plot.ts</span><span class="p">(</span><span class="n">data</span><span class="o">^</span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="s2">""</span><span class="o">*</span><span class="n">lambda</span><span class="o">*</span><span class="s2">" = -2"</span><span class="p">))</span><span class="w">
  </span><span class="n">plot.ts</span><span class="p">(</span><span class="n">data</span><span class="o">^</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="s2">""</span><span class="o">*</span><span class="n">lambda</span><span class="o">*</span><span class="s2">" = -1"</span><span class="p">))</span><span class="w">
  </span><span class="n">plot.ts</span><span class="p">(</span><span class="n">data</span><span class="o">^</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="s2">""</span><span class="o">*</span><span class="n">lambda</span><span class="o">*</span><span class="s2">" = 1"</span><span class="p">))</span><span class="w">
  </span><span class="n">plot.ts</span><span class="p">(</span><span class="n">data</span><span class="o">^</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="s2">""</span><span class="o">*</span><span class="n">lambda</span><span class="o">*</span><span class="s2">" = 2"</span><span class="p">))</span><span class="w">
  </span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w">
  </span><span class="n">plot.ts</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="s2">""</span><span class="o">*</span><span class="n">lambda</span><span class="o">*</span><span class="s2">" = 0"</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">transformPlots</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">)</span><span class="w">
</span><span class="n">boxcox</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="o">~</span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="c1"># Trend and Seasonality</span><span class="w">
</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">)</span><span class="w">
</span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trndseas</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">,</span><span class="w"> </span><span class="n">degtrnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">seas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">)</span><span class="w">
</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">,</span><span class="w">
        </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log Avg receipts per theater for Chicago (Jan 3, 2003 to Apr 18, 2003"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">mod</span><span class="o">$</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'l'</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'red'</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"topright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Observed data"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Fitted smooth"</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="s2">"red"</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plots of the trend, seasonal component, rough</span><span class="w">
</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">mod</span><span class="o">$</span><span class="n">trend</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Trend of average receipts per theater"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">)</span><span class="w">
</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">mod</span><span class="o">$</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Seasonality of average receipts per theater"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">)</span><span class="w">
</span><span class="n">rough</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mod</span><span class="o">$</span><span class="n">fit</span><span class="w">
</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">rough</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Rough of Average receipts per theater"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Diagnostics for the Rough</span><span class="w">
</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">rough</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Rough of Average receipts per theater"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">rough</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">rough</span><span class="p">)</span><span class="w">
</span><span class="n">hist</span><span class="p">(</span><span class="n">rough</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w">
</span><span class="n">Box.test</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">,</span><span class="w"> </span><span class="n">lag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ljung-Box"</span><span class="p">)</span><span class="w">
</span><span class="n">acf</span><span class="p">(</span><span class="n">rough</span><span class="p">)</span><span class="w">
</span><span class="n">pacf</span><span class="p">(</span><span class="n">rough</span><span class="p">)</span><span class="w">

</span><span class="c1"># Obtaining an appropriate AR(p) model</span><span class="w">
</span><span class="n">AR.Fitter</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">){</span><span class="w">
  </span><span class="n">Result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">i</span><span class="p">){</span><span class="w">
    </span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">arima</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w">
    </span><span class="nf">return</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">aicc</span><span class="p">(</span><span class="n">fit</span><span class="p">)))</span><span class="w">
  </span><span class="p">})</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">Result</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">models</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">AR.Fitter</span><span class="p">(</span><span class="n">rough</span><span class="p">)</span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">arima</span><span class="p">(</span><span class="n">rough</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w">
</span><span class="n">acf</span><span class="p">(</span><span class="n">fit</span><span class="o">$</span><span class="n">residuals</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"AR(1) fit residuals"</span><span class="p">)</span><span class="w">
</span><span class="n">pacf</span><span class="p">(</span><span class="n">fit</span><span class="o">$</span><span class="n">residuals</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"AR(1) fit residuals"</span><span class="p">)</span><span class="w">
</span><span class="n">Box.test</span><span class="p">(</span><span class="n">fit</span><span class="o">$</span><span class="n">residuals</span><span class="p">,</span><span class="w"> </span><span class="n">lag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Ljung-Box"</span><span class="p">)</span><span class="w">

</span><span class="c1">## With the first 99 observations</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">99</span><span class="w">
</span><span class="n">h</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">7</span><span class="w">
</span><span class="n">mod0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trndseas</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">],</span><span class="w"> </span><span class="n">degtrnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">seas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">)</span><span class="w">
</span><span class="n">m.fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mod0</span><span class="o">$</span><span class="n">trend</span><span class="w">
</span><span class="n">s.fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">mod0</span><span class="o">$</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w">
</span><span class="n">smooth.fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mod0</span><span class="o">$</span><span class="n">fit</span><span class="w">
</span><span class="n">deg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">4</span><span class="w">
</span><span class="n">coef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mod0</span><span class="o">$</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">(</span><span class="n">deg</span><span class="m">+1</span><span class="p">)]</span><span class="w">
</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">h</span><span class="p">))</span><span class="o">/</span><span class="n">n</span><span class="w">
</span><span class="n">predmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">deg</span><span class="p">)</span><span class="o">^</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">deg</span><span class="p">,</span><span class="n">each</span><span class="o">=</span><span class="n">h</span><span class="p">),</span><span class="n">nrow</span><span class="o">=</span><span class="n">h</span><span class="p">,</span><span class="n">byrow</span><span class="o">=</span><span class="nb">F</span><span class="p">)</span><span class="w">
</span><span class="n">predmat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">h</span><span class="p">),</span><span class="n">predmat</span><span class="p">)</span><span class="w">

</span><span class="n">rough0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mod0</span><span class="o">$</span><span class="n">fit</span><span class="w">
</span><span class="n">fit0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">arima</span><span class="p">(</span><span class="n">rough0</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w">

</span><span class="n">m.fc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predmat</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">coef</span><span class="w">
</span><span class="n">s.fc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">mod0</span><span class="o">$</span><span class="n">season</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="n">n</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="w">
</span><span class="n">s.fc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.fc</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)]</span><span class="w">
</span><span class="n">fcast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">fit0</span><span class="p">,</span><span class="n">n.ahead</span><span class="o">=</span><span class="n">h</span><span class="p">)</span><span class="w">
</span><span class="n">x.fc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fcast</span><span class="o">$</span><span class="n">pred</span><span class="w">
</span><span class="n">y.fc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m.fc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s.fc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x.fc</span><span class="w">

</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">],</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="n">h</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">),</span><span class="w">
        </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">,</span><span class="w">
        </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log Avg receipts per theater for Chicago (Jan 3, 2003 to Apr 18, 2003"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="m">+1</span><span class="o">:</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">y.fc</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'purple'</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="m">+1</span><span class="o">:</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">[</span><span class="m">100</span><span class="o">:</span><span class="m">106</span><span class="p">],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"topright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Observed data"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Fitted smooth"</span><span class="p">),</span><span class="w">
       </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"purple"</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">19</span><span class="p">))</span><span class="w">
</span><span class="n">y.fc</span><span class="w">
</span><span class="n">a</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">y.fc</span><span class="p">)</span><span class="w">
</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">chicago1</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">],</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="n">h</span><span class="p">),</span><span class="w">
        </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">,</span><span class="w">
        </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Avg receipts per theater for Chicago (Jan 3, 2003 to Apr 18, 2003"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="m">+1</span><span class="o">:</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">a</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'purple'</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="m">+1</span><span class="o">:</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">chicago1</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">[</span><span class="m">100</span><span class="o">:</span><span class="m">106</span><span class="p">],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"topright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Observed data"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Fitted smooth"</span><span class="p">),</span><span class="w">
       </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="s2">"purple"</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">19</span><span class="p">))</span><span class="w">

</span><span class="c1">## With the best model using ALL observations</span><span class="w">
</span><span class="n">m.fit1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mod</span><span class="o">$</span><span class="n">trend</span><span class="w">
</span><span class="n">s.fit1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">mod</span><span class="o">$</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w">
</span><span class="n">smooth.fit1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mod</span><span class="o">$</span><span class="n">fit</span><span class="w">
</span><span class="n">deg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">4</span><span class="w">
</span><span class="n">coef1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mod</span><span class="o">$</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="p">(</span><span class="n">deg</span><span class="m">+1</span><span class="p">)]</span><span class="w">
</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">h</span><span class="p">))</span><span class="o">/</span><span class="n">n</span><span class="w">
</span><span class="n">predmat1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">deg</span><span class="p">)</span><span class="o">^</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">deg</span><span class="p">,</span><span class="n">each</span><span class="o">=</span><span class="n">h</span><span class="p">),</span><span class="n">nrow</span><span class="o">=</span><span class="n">h</span><span class="p">,</span><span class="n">byrow</span><span class="o">=</span><span class="nb">F</span><span class="p">)</span><span class="w">
</span><span class="n">predmat1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">h</span><span class="p">),</span><span class="n">predmat1</span><span class="p">)</span><span class="w">

</span><span class="n">m.fc1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predmat1</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">coef1</span><span class="w">
</span><span class="n">s.fc1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">mod</span><span class="o">$</span><span class="n">season</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="n">n</span><span class="o">+</span><span class="n">h</span><span class="p">)</span><span class="w">
</span><span class="n">s.fc1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.fc1</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">)]</span><span class="w">
</span><span class="n">fcast1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">n.ahead</span><span class="o">=</span><span class="n">h</span><span class="p">)</span><span class="w">
</span><span class="n">x.fc1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fcast1</span><span class="o">$</span><span class="n">pred</span><span class="w">
</span><span class="n">y.fc1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m.fc1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s.fc1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x.fc1</span><span class="w">

</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">chicago</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="n">h</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">),</span><span class="w">
        </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">,</span><span class="w">
        </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"log Avg receipts per theater for Chicago (Jan 3, 2003 to Apr 18, 2003"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="m">+1</span><span class="o">:</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">y.fc</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'purple'</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"topright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Observed data"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Fitted smooth"</span><span class="p">),</span><span class="w">
       </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="s2">"purple"</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">19</span><span class="p">))</span><span class="w">
</span><span class="n">y.fc1</span><span class="w">
</span><span class="n">a</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="n">y.fc1</span><span class="p">)</span><span class="w">
</span><span class="n">plot.ts</span><span class="p">(</span><span class="n">chicago1</span><span class="o">$</span><span class="n">`Average receipts per theater`</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="n">h</span><span class="p">),</span><span class="w">
        </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Average receipts per theater"</span><span class="p">,</span><span class="w">
        </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Avg receipts per theater for Chicago (Jan 3, 2003 to Apr 18, 2003"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="m">+1</span><span class="o">:</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">a</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'purple'</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"topright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Observed data"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Fitted smooth"</span><span class="p">),</span><span class="w">
       </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="s2">"purple"</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">19</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>


      <footer class="site-footer">
  <span class="site-footer-owner"><a href="http://localhost:4000">cwong8.github.io</a> is maintained by <a href="https://github.com/cwong8">Christopher Wong</a>.</span>
  <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
</footer>


    </section>

  </body>
</html>
